/* --- 1. CORRECTION DU SCROLL (CRITIQUE) --- */
/* On force la barre de navigation latérale à devenir une colonne flexible */
nav, nav[role="navigation"] {
    display: flex !important;
    flex-direction: column !important;
    height: 100vh !important;
    max-height: 100vh !important;
    overflow: hidden !important;
}

/* Notre panneau ne doit jamais rétrécir */
#gemini-ultimate-panel {
    flex: 0 0 auto !important;
    background-color: #1e1f20; /* Fond sombre Gemini */
    border-bottom: 1px solid #444746;
    z-index: 100;
    max-height: 50vh;
    display: flex;
    flex-direction: column;
}

/* La zone de liste de chats originale de Google DOIT prendre l'espace restant et scroller */
div[data-test-id="overflow-container"], .overflow-container {
    flex: 1 1 auto !important;
    overflow-y: auto !important;
    min-height: 0 !important;
    margin-top: 0 !important;
    padding-top: 10px !important;
}

/* --- 2. DESIGN GÉNÉRAL DU PANNEAU --- */
.gu-header {
    padding: 12px 16px 0;
}

.gu-tabs {
    display: flex;
    gap: 15px;
    margin-bottom: 10px;
    border-bottom: 1px solid #444;
}

.gu-tab {
    color: #9aa0a6;
    padding-bottom: 5px;
    cursor: pointer;
    font-size: 13px;
    font-weight: 500;
    border-bottom: 2px solid transparent;
}

.gu-tab.active {
    color: #e3e3e3;
    border-bottom-color: #0b57d0;
}

.gu-controls {
    display: flex;
    gap: 8px;
    margin-bottom: 10px;
}

.gu-search {
    flex: 1;
    background: #282a2c;
    border: 1px solid #444746;
    border-radius: 4px;
    padding: 6px 10px;
    color: #e3e3e3;
    font-size: 12px;
    outline: none;
}
.gu-search:focus { border-color: #0b57d0; }

.gu-icon-btn {
    background: transparent; border: none; cursor: pointer; font-size: 16px; color: #9aa0a6; padding: 2px;
}
.gu-icon-btn:hover { color: white; }

.gu-scroll-area {
    overflow-y: auto;
    padding-bottom: 10px;
    scrollbar-width: thin;
}

/* --- 3. DESIGN DES DOSSIERS --- */
.gu-folder {
    margin: 2px 0;
    border-left: 3px solid transparent;
}
.gu-folder-header {
    padding: 8px 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    color: #e3e3e3;
    font-size: 13px;
    user-select: none;
}
.gu-folder-header:hover { background-color: #2d2e31; }
.gu-folder-header:hover .gu-folder-actions { display: flex; }

.gu-folder-title-group { display: flex; align-items: center; gap: 8px; overflow: hidden; }
.gu-arrow { font-size: 10px; color: #9aa0a6; width: 10px; }

.gu-folder-actions {
    display: none; /* Caché par défaut */
    gap: 5px;
    align-items: center;
}

.gu-count { font-size: 10px; background: #444; padding: 1px 6px; border-radius: 10px; color: #ccc; }

.gu-folder-content { display: none; background-color: rgba(0,0,0,0.2); }
.gu-folder-content.open { display: block; }

/* Lien Chat */
.gu-chat-link {
    display: block;
    padding: 6px 16px 6px 34px;
    color: #c4c7c5;
    text-decoration: none;
    font-size: 13px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    position: relative;
}
.gu-chat-link:hover { background-color: #3c4043; color: white; }
.gu-chat-remove {
    position: absolute; right: 10px; top: 50%; transform: translateY(-50%);
    display: none; color: #8e918f; font-weight: bold; cursor: pointer;
}
.gu-chat-link:hover .gu-chat-remove { display: block; }
.gu-chat-remove:hover { color: #ff8989; }

/* --- 4. PROMPT MANAGER --- */
.gu-prompt-item {
    padding: 10px 16px;
    border-bottom: 1px solid #303030;
    cursor: pointer;
}
.gu-prompt-item:hover { background-color: #2d2e31; }
.gu-prompt-title { color: #e3e3e3; font-weight: 500; font-size: 13px; margin-bottom: 4px; }
.gu-prompt-text { color: #9aa0a6; font-size: 11px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.gu-tag { display: inline-block; width: 8px; height: 8px; border-radius: 50%; margin-right: 6px; }

/* --- 5. BOUTON ADD DANS LA LISTE --- */
.gu-add-chat-btn {
    width: 24px; height: 24px; border-radius: 50%;
    display: inline-flex; align-items: center; justify-content: center;
    cursor: pointer; margin-left: auto; margin-right: 10px;
    color: #c4c7c5; background: rgba(255,255,255,0.1);
    font-weight: bold; font-size: 16px; z-index: 100;
    position: absolute; right: 40px; top: 50%; transform: translateY(-50%);
    border: 1px solid rgba(255,255,255,0.1);
    transition: 0.2s;
}
.gu-add-chat-btn:hover { background: #0b57d0; color: white; transform: translateY(-50%) scale(1.1); }